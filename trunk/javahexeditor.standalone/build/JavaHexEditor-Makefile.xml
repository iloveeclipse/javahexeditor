<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_run_jars" name="Create Runnable Jars for Project net.sourceforge.javahexeditor.standalone with Jar-in-Jar Loader">
	<!--this file was created by Eclipse Runnable JAR Export Wizard-->
	<!--ANT 1.7 is required                                        -->
	<target name="create_run_jars">

		<mkdir dir="../out" />
		<mkdir dir="../out/linux-x86" />
		<mkdir dir="../out/win32-x86" />
		<mkdir dir="../out/win32-x86_64" />

		<delete file="../out/linux-x86/JavaHexEditor.jar" />
		<jar destfile="../out/linux-x86/JavaHexEditor.jar">
			<manifest>
				<attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader" />
				<attribute name="Class-Path" value="." />
				<attribute name="Rsrc-Main-Class" value="net.sourceforge.javahexeditor.standalone.HexEditor" />
				<attribute name="Rsrc-Class-Path" value="./ org.eclipse.osgi.jar swt.jar" />
			</manifest>
			<zipfileset src="../lib/jar-in-jar-loader.zip" />
			<fileset dir="../../net.sourceforge.javahexeditor/bin">
				<exclude name="net/sourceforge/javahexeditor/test/**" />
			</fileset>
			<fileset dir="../bin" />
			<zipfileset dir="../lib" includes="org.eclipse.osgi.jar" />
			<zipfileset dir="../lib/linux-x86" includes="swt.jar" />
		</jar>

		<delete file="../out/win32-x86/JavaHexEditor.jar" />
		<jar destfile="../out/win32-x86/JavaHexEditor.jar">
			<manifest>
				<attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader" />
				<attribute name="Class-Path" value="." />
				<attribute name="Rsrc-Main-Class" value="net.sourceforge.javahexeditor.standalone.HexEditor" />
				<attribute name="Rsrc-Class-Path" value="./ org.eclipse.osgi.jar swt.jar" />
			</manifest>
			<zipfileset src="../lib/jar-in-jar-loader.zip" />
			<fileset dir="../../net.sourceforge.javahexeditor/bin">
				<exclude name="net/sourceforge/javahexeditor/test/**" />
			</fileset>
			<fileset dir="../bin" />
			<zipfileset dir="../lib" includes="org.eclipse.osgi.jar" />
			<zipfileset dir="../lib/win32-x86" includes="swt.jar" />
		</jar>

		<delete file="../out/win32-x86_64/JavaHexEditor.jar" />
		<jar destfile="../out/win32-x86_64/JavaHexEditor.jar">
			<manifest>
				<attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader" />
				<attribute name="Class-Path" value="." />
				<attribute name="Rsrc-Main-Class" value="net.sourceforge.javahexeditor.standalone.HexEditor" />
				<attribute name="Rsrc-Class-Path" value="./ org.eclipse.osgi.jar swt.jar" />
			</manifest>
			<zipfileset src="../lib/jar-in-jar-loader.zip" />
			<fileset dir="../../net.sourceforge.javahexeditor/bin">
				<exclude name="net/sourceforge/javahexeditor/test/**" />
			</fileset>
			<fileset dir="../bin" />
			<zipfileset dir="../lib" includes="org.eclipse.osgi.jar" />
			<zipfileset dir="../lib/win32-x86_64" includes="swt.jar" />
		</jar>


		<!-- Create exe wrappers/scripts -->
		<copy file="../build/JavaHexEditor.sh" tofile="../out/linux-x86/JavaHexEditor.sh" />
		<exec executable="C:\Program Files (x86)\Launch4j\launch4jc.exe">
			<arg value="./JavaHexEditor-win32-x86.launch4j.xml" />
		</exec>
		<exec executable="C:\Program Files (x86)\Launch4j\launch4jc.exe">
			<arg value="./JavaHexEditor-win32-x86_64.launch4j.xml" />
		</exec>

		<!-- Remove jars that have been wrapped before zipping -->
		<delete file="../out/win32-x86/JavaHexEditor.jar" />
		<delete file="../out/win32-x86_64/JavaHexEditor.jar" />

		<!-- Create zip files for upload -->
		<delete file="../out/linux-x86/javahexeditor-linux-x86.zip" />
		<zip destfile="../out/javahexeditor-linux-x86.zip" basedir="../out/linux-x86" />
		<delete file="../out/linux-x86/javahexeditor-win32-x86.zip" />
		<zip destfile="../out/javahexeditor-win32-x86.zip" basedir="../out/win32-x86" />
		<delete file="../out/linux-x86/javahexeditor-win32-x86_64.zip" />
		<zip destfile="../out/javahexeditor-win32-x86_64.zip" basedir="../out/win32-x86_64" />
		
		
		<delete dir="../out/linux-x86" />
		<delete dir="../out/win32-x86" />
		<delete dir="../out/win32-x86_64" />
	</target>
</project>
